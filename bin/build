#!/usr/bin/env ruby
# frozen_string_literal: true

require 'open3'
require_relative '../lib/ssh_key_switcher/version'

def exec(cmd)
  puts cmd
  stdout, stderr, = Open3.capture3('bundle exec rake install')
  print stdout
  print stderr
end

gemname = 'ssh_key_switcher'
gemfile = File.expand_path("pkg/#{gemname}-#{SshKeySwitcher::VERSION}.gem")

exec("rm #{gemfile}")
exec('bundle exec rake install')
exec("gem uninstall #{gemname}")
exec("gem install #{gemfile}")
